import streamlit as st
import pandas as pd
import plotly.graph_objects as go
import plotly.express as px
from datetime import datetime
import time
import json

# ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ
st.set_page_config(
    page_title="ุฃุฏุงุฉ ุงูุงุณุชุดุฑุงู ุงูุฐูู",
    page_icon="๐ฎ",
    layout="wide",
    initial_sidebar_state="collapsed"
)

# CSS ูุฎุตุต ูุชุญุณูู ุงููุธูุฑ
st.markdown("""
<style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');

    * {
        font-family: 'Cairo', sans-serif !important;
    }

    .main {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        direction: rtl;
    }

    .stButton>button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-size: 18px;
        font-weight: 600;
        padding: 15px 40px;
        border: none;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        transition: all 0.3s ease;
        width: 100%;
    }

    .stButton>button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    .header-title {
        text-align: center;
        color: #2d3748;
        font-size: 48px;
        font-weight: 700;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }

    .header-subtitle {
        text-align: center;
        color: #4a5568;
        font-size: 20px;
        font-weight: 400;
        margin-bottom: 40px;
    }

    .scenario-card {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        margin: 20px 0;
        border-right: 5px solid;
        transition: transform 0.3s ease;
    }

    .scenario-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 30px rgba(0,0,0,0.15);
    }

    .optimistic {
        border-color: #48bb78;
    }

    .realistic {
        border-color: #4299e1;
    }

    .pessimistic {
        border-color: #f56565;
    }

    .metric-card {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        text-align: center;
    }

    .metric-value {
        font-size: 32px;
        font-weight: 700;
        color: #667eea;
    }

    .metric-label {
        font-size: 14px;
        color: #718096;
        margin-top: 5px;
    }

    .section-header {
        font-size: 28px;
        font-weight: 700;
        color: #2d3748;
        margin: 30px 0 20px 0;
        padding-bottom: 10px;
        border-bottom: 3px solid #667eea;
    }

    .disclaimer {
        background: #fff5f5;
        border-right: 4px solid #fc8181;
        padding: 15px;
        border-radius: 8px;
        margin-top: 30px;
        color: #742a2a;
        font-size: 14px;
    }

    .stTextInput>div>div>input, .stTextArea>div>div>textarea, .stSelectbox>div>div>select {
        background: white;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        padding: 10px;
        font-size: 16px;
    }

    .stTextInput>div>div>input:focus, .stTextArea>div>div>textarea:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .opportunity-item {
        background: #f0fff4;
        border-right: 4px solid #48bb78;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
    }

    .risk-item {
        background: #fff5f5;
        border-right: 4px solid #f56565;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
    }

    .question-item {
        background: #ebf8ff;
        border-right: 4px solid #4299e1;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
    }
</style>
""", unsafe_allow_html=True)

# ุฏุงูุฉ ูุชูููุฏ ุงูุณููุงุฑูููุงุช ุจูุงุกู ุนูู ุงููุฏุฎูุงุช
def generate_scenarios(project_type, location, sector, time_horizon, concern):
    """ุชูููุฏ ุณููุงุฑูููุงุช ูุณุชูุจููุฉ ุฐููุฉ ุจูุงุกู ุนูู ุงููุฏุฎูุงุช"""

    # ูุงุนุฏุฉ ุจูุงูุงุช ููุณููุงุฑูููุงุช ุญุณุจ ุงููุทุงุนุงุช
    scenarios_db = {
        "ุชูููุฉ ุงููุนูููุงุช": {
            "optimistic": {
                "title": "ุงูุชุญูู ุงูุฑููู ุงููุงุฌุญ",
                "summary": "ุชุญููู ููู ูุชุณุงุฑุน ูู ุงูุณูู ูุน ุชุจูู ูุงุณุน ููุญููู ุงูุชูููุฉ",
                "details": [
                    "ุฒูุงุฏุฉ ุงูุทูุจ ุนูู ุงูุญููู ุงูุฑูููุฉ ุจูุณุจุฉ 150% ุฎูุงู ุงูุณููุงุช ุงูุซูุงุซ ุงููุงุฏูุฉ",
                    "ุฌุฐุจ ุงุณุชุซูุงุฑุงุช ูุจูุฑุฉ ูู ุตูุงุฏูู ุฑุฃุณ ุงููุงู ุงูุฌุฑูุก",
                    "ุชูุณุน ุฌุบุฑุงูู ูุงุฌุญ ุฅูู 5 ุฃุณูุงู ุฅูููููุฉ ุฌุฏูุฏุฉ",
                    "ุจูุงุก ูุฑูู ุชููู ูุชููุฒ ูุฒูุงุฏุฉ ุงูุฅูุชุงุฌูุฉ ุจูุณุจุฉ 200%"
                ],
                "probability": 30,
                "impact": "ุนุงูู ุฌุฏุงู"
            },
            "realistic": {
                "title": "ุงูููู ุงููุณุชูุฑ ูุงููุชูุงุฒู",
                "summary": "ุชุญููู ููู ูุนุชุฏู ูุน ููุงุฌูุฉ ุชุญุฏูุงุช ุงูุณูู ุจูุฌุงุญ",
                "details": [
                    "ููู ุณููู ุซุงุจุช ุจูุนุฏู 30-40% ูู ุงูุฅูุฑุงุฏุงุช",
                    "ููุงูุณุฉ ูุชุฒุงูุฏุฉ ุชุชุทูุจ ุชุทููุฑ ูุณุชูุฑ ููููุชุฌ",
                    "ุงูุญุงุฌุฉ ูููุงุฒูุฉ ุจูู ุงูุงุจุชูุงุฑ ูุงูุฑุจุญูุฉ",
                    "ุงุณุชูุทุงุจ ููุงูุจ ุชูููุฉ ูู ุณูู ุชูุงูุณู"
                ],
                "probability": 50,
                "impact": "ูุชูุณุท ุฅูู ุนุงูู"
            },
            "pessimistic": {
                "title": "ุชุญุฏูุงุช ุงูุณูู ูุงูููุงูุณุฉ",
                "summary": "ููุงุฌูุฉ ุตุนูุจุงุช ูู ุชุญููู ุงูููู ุงููุณุชูุฏู",
                "details": [
                    "ุฏุฎูู ููุงูุณูู ุฃููู ุจุญููู ุฃูุถู ูุฃุณุนุงุฑ ููุงูุณุฉ",
                    "ุตุนูุจุฉ ูู ุงูุญุตูู ุนูู ุงูุชูููู ูู ุจูุฆุฉ ุงูุชุตุงุฏูุฉ ุตุนุจุฉ",
                    "ุชุญุฏูุงุช ูู ุงูุงุญุชูุงุธ ุจุงูููุงูุจ ุงูุชูููุฉ",
                    "ุจุทุก ูู ุงูุชุจูู ูู ูุจู ุงูุนููุงุก ุงููุญุชูููู"
                ],
                "probability": 20,
                "impact": "ูุชูุณุท"
            }
        },
        "ุงูุฎุฏูุงุช ุงูุบุฐุงุฆูุฉ": {
            "optimistic": {
                "title": "ูุฌุงุญ ุจุงูุฑ ูุชูุณุน ุณุฑูุน",
                "summary": "ุจูุงุก ุนูุงูุฉ ุชุฌุงุฑูุฉ ูููุฉ ูุน ุชูุณุน ูู ุนุฏุฉ ูุฑูุน",
                "details": [
                    "ุชุญููู ุดูุฑุฉ ูุงุณุนุฉ ูุฅูุจุงู ูุจูุฑ ูู ุงูุนููุงุก",
                    "ุงูุชุชุงุญ 3-4 ูุฑูุน ุฌุฏูุฏุฉ ุฎูุงู ุงูุณูุชูู ุงููุงุฏูุชูู",
                    "ุจูุงุก ูุงุนุฏุฉ ุนููุงุก ูุฎูุตูู ูุชูุฑุงุฑ ุงูุฒูุงุฑุงุช",
                    "ุชุญููู ููุงูุด ุฑุจุญ ุนุงููุฉ ุชุตู ุฅูู 25-30%"
                ],
                "probability": 25,
                "impact": "ุนุงูู ุฌุฏุงู"
            },
            "realistic": {
                "title": "ุชุฃุณูุณ ุญุถูุฑ ูุณุชูุฑ ูู ุงูุณูู",
                "summary": "ุจูุงุก ุณูุนุฉ ุฌูุฏุฉ ูุน ููู ุชุฏุฑูุฌู ูุณุชุฏุงู",
                "details": [
                    "ููู ุซุงุจุช ูู ูุงุนุฏุฉ ุงูุนููุงุก ุจูุนุฏู 15-20% ุณูููุงู",
                    "ููุงูุณุฉ ูููุฉ ุชุชุทูุจ ุชูุงูุฒ ูุณุชูุฑ ูู ุงูุฌูุฏุฉ ูุงูุฎุฏูุฉ",
                    "ุชุญุฏูุงุช ูู ุฅุฏุงุฑุฉ ุงูุชูุงููู ูุงููุฎุฒูู",
                    "ุงูุญุงุฌุฉ ููุชููู ูุน ุชุบูุฑ ุฃุฐูุงู ุงูุนููุงุก"
                ],
                "probability": 55,
                "impact": "ูุชูุณุท"
            },
            "pessimistic": {
                "title": "ุตุนูุจุงุช ุชุดุบูููุฉ ููุงููุฉ",
                "summary": "ููุงุฌูุฉ ุชุญุฏูุงุช ูู ุชุญููู ุงูุงุณุชุฏุงูุฉ ุงููุงููุฉ",
                "details": [
                    "ุงุฑุชูุงุน ุชูุงููู ุงูููุงุฏ ุงูุฎุงู ูุงูุนูุงูุฉ ุจุดูู ุบูุฑ ูุชููุน",
                    "ููุงูุณุฉ ุดุฑุณุฉ ูู ูุทุงุนู ุฑุงุณุฎุฉ ูุณูุงุณู ูุจูุฑุฉ",
                    "ุตุนูุจุฉ ูู ุฌุฐุจ ุนุฏุฏ ูุงูู ูู ุงูุนููุงุก ูู ุงูุฃุดูุฑ ุงูุฃููู",
                    "ุชุญุฏูุงุช ูู ุงูุญูุงุธ ุนูู ุฌูุฏุฉ ุงูุทุนุงู ูุงูุฎุฏูุฉ"
                ],
                "probability": 20,
                "impact": "ุนุงูู"
            }
        },
        "ุงูุชุนููู ูุงูุชุฏุฑูุจ": {
            "optimistic": {
                "title": "ุฑูุงุฏุฉ ูู ุงูุชุนููู ุงูุญุฏูุซ",
                "summary": "ุจูุงุก ูุคุณุณุฉ ุชุนููููุฉ ุฑุงุฆุฏุฉ ููุคุซุฑุฉ",
                "details": [
                    "ุทูุจ ูุชุฒุงูุฏ ุนูู ุงูุจุฑุงูุฌ ุงูุชุฏุฑูุจูุฉ ุจูุณุจุฉ 100% ุณูููุงู",
                    "ุดุฑุงูุงุช ุงุณุชุฑุงุชูุฌูุฉ ูุน ูุคุณุณุงุช ุชุนููููุฉ ุนุงูููุฉ",
                    "ุงุนุชูุงุฏ ูููุฐุฌ ุชุนููู ูุจุชูุฑ ูุญูู ูุชุงุฆุฌ ูุชููุฒุฉ",
                    "ุชูุณุน ูู ุงูุชุนููู ุงูุฅููุชุฑููู ูุงููุตูู ูุขูุงู ุงููุชุฏุฑุจูู"
                ],
                "probability": 30,
                "impact": "ุนุงูู ุฌุฏุงู"
            },
            "realistic": {
                "title": "ุจูุงุก ุณูุนุฉ ุชุนููููุฉ ูุญุชุฑูุฉ",
                "summary": "ุชูุฏูู ุจุฑุงูุฌ ุชุนููููุฉ ุฐุงุช ุฌูุฏุฉ ูุน ููู ูุนุชุฏู",
                "details": [
                    "ููู ุซุงุจุช ูู ุฃุนุฏุงุฏ ุงููุชุฏุฑุจูู ุจูุนุฏู 25-35% ุณูููุงู",
                    "ุจูุงุก ุณูุนุฉ ุฌูุฏุฉ ูู ูุฌุงู ุงูุชุฎุตุต",
                    "ููุงูุณุฉ ูู ูุคุณุณุงุช ุชุนููููุฉ ุชูููุฏูุฉ ูุนุจุฑ ุงูุฅูุชุฑูุช",
                    "ุงูุญุงุฌุฉ ููุชุทููุฑ ุงููุณุชูุฑ ููููุงูุฌ ูุงููุฏุฑุจูู"
                ],
                "probability": 50,
                "impact": "ูุชูุณุท ุฅูู ุนุงูู"
            },
            "pessimistic": {
                "title": "ุตุนูุจุงุช ูู ุงูุชูุงูุฒ ูุงูููู",
                "summary": "ููุงุฌูุฉ ุชุญุฏูุงุช ูู ุฌุฐุจ ุงููุชุฏุฑุจูู ูุชุญููู ุงูุงุณุชุฏุงูุฉ",
                "details": [
                    "ุชุดุจุน ุงูุณูู ุจุงูููุงูุณูู ูู ููุณ ุงููุฌุงู",
                    "ุตุนูุจุฉ ูู ุฅุซุจุงุช ุงููููุฉ ุงููุถุงูุฉ ููุจุฑุงูุฌ",
                    "ุชุญุฏูุงุช ูู ุฌุฐุจ ูุฏุฑุจูู ุฃููุงุก ุจุชูููุฉ ูุนูููุฉ",
                    "ุงูุฎูุงุถ ุงูุทูุจ ูู ุจุนุถ ุงููุชุฑุงุช ุงูููุณููุฉ"
                ],
                "probability": 20,
                "impact": "ูุชูุณุท"
            }
        },
        "ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ": {
            "optimistic": {
                "title": "ููู ูุงุฆู ูู ุงููุจูุนุงุช ุงูุฑูููุฉ",
                "summary": "ุชุญููู ูุฌุงุญ ูุจูุฑ ูุน ุงูุชูุณุน ุงูุณุฑูุน ูู ุงูุณูู ุงูุฑููู",
                "details": [
                    "ููู ุงููุจูุนุงุช ุจูุนุฏู 200% ุณูููุงู ูุน ุชูุณุน ูุงุนุฏุฉ ุงูุนููุงุก",
                    "ุจูุงุก ููุตุฉ ุฑูููุฉ ูุชููุฒุฉ ุจุชุฌุฑุจุฉ ูุณุชุฎุฏู ุงุณุชุซูุงุฆูุฉ",
                    "ุฌุฐุจ ุงุณุชุซูุงุฑุงุช ููุชูุณุน ุงูุฅููููู",
                    "ุชุญููู ููุฒุฉ ุชูุงูุณูุฉ ูู ุฎูุงู ุงูุงุจุชูุงุฑ ูู ุงูุฎุฏูุงุช ุงูููุฌุณุชูุฉ"
                ],
                "probability": 28,
                "impact": "ุนุงูู ุฌุฏุงู"
            },
            "realistic": {
                "title": "ุจูุงุก ุญุถูุฑ ุฑููู ูุณุชูุฑ",
                "summary": "ุชุญููู ููู ูุนุชุฏู ูู ุณูู ุชูุงูุณู",
                "details": [
                    "ููู ุซุงุจุช ุจูุนุฏู 40-50% ุณูููุงู ูุน ููุงูุณุฉ ูุชุฒุงูุฏุฉ",
                    "ุงูุญุงุฌุฉ ูุงุณุชุซูุงุฑ ูุณุชูุฑ ูู ุงูุชุณููู ุงูุฑููู",
                    "ุชุญุฏูุงุช ูู ุฅุฏุงุฑุฉ ุณูุณูุฉ ุงูุชูุฑูุฏ ูุงูุดุญู",
                    "ููุงุฒูุฉ ุจูู ุงูููู ูููุงูุด ุงูุฑุจุญ"
                ],
                "probability": 52,
                "impact": "ูุชูุณุท ุฅูู ุนุงูู"
            },
            "pessimistic": {
                "title": "ููุงูุณุฉ ุดุฑุณุฉ ูุชุญุฏูุงุช ุชุดุบูููุฉ",
                "summary": "ุตุนูุจุงุช ูู ุงูุชูุงูุฒ ูุชุญููู ุงูุฑุจุญูุฉ",
                "details": [
                    "ููุงูุณุฉ ูููุฉ ูู ููุตุงุช ูุจุฑู ุฑุงุณุฎุฉ",
                    "ุงุฑุชูุงุน ุชูุงููู ุงูุชุณุงุจ ุงูุนููุงุก ูุงูุชุณููู ุงูุฑููู",
                    "ูุดุงูู ูู ุงูุฎุฏูุงุช ุงูููุฌุณุชูุฉ ูุฅุฑุฌุงุน ุงูููุชุฌุงุช",
                    "ุตุนูุจุฉ ูู ุจูุงุก ุงูุซูุฉ ูุน ุงูุนููุงุก ุงูุฌุฏุฏ"
                ],
                "probability": 20,
                "impact": "ูุชูุณุท ุฅูู ุนุงูู"
            }
        },
        "ุงูุตุญุฉ ูุงูุนุงููุฉ": {
            "optimistic": {
                "title": "ููุงุฏุฉ ุซูุฑุฉ ุงูุตุญุฉ ุงูููุงุฆูุฉ",
                "summary": "ุจูุงุก ูุคุณุณุฉ ุตุญูุฉ ุฑุงุฆุฏุฉ ูุน ุชุฃุซูุฑ ุฅูุฌุงุจู ูุจูุฑ",
                "details": [
                    "ูุนู ูุชุฒุงูุฏ ุจุฃูููุฉ ุงูุตุญุฉ ุงูููุงุฆูุฉ ูุงูุนุงููุฉ",
                    "ููู ุงูุทูุจ ุนูู ุงูุฎุฏูุงุช ุงูุตุญูุฉ ุงููุชุฎุตุตุฉ ุจูุณุจุฉ 120%",
                    "ุดุฑุงูุงุช ูุน ูุคุณุณุงุช ุตุญูุฉ ูุดุฑูุงุช ุชุฃููู",
                    "ุชุทููุฑ ุจุฑุงูุฌ ุตุญูุฉ ูุจุชูุฑุฉ ุชุญูู ูุชุงุฆุฌ ููููุณุฉ"
                ],
                "probability": 32,
                "impact": "ุนุงูู ุฌุฏุงู"
            },
            "realistic": {
                "title": "ุชูุฏูู ุฎุฏูุงุช ุตุญูุฉ ุฐุงุช ุฌูุฏุฉ",
                "summary": "ุจูุงุก ุณูุนุฉ ุทูุจุฉ ูุน ููู ูุณุชูุฑ ูู ูุงุนุฏุฉ ุงูุนููุงุก",
                "details": [
                    "ููู ุซุงุจุช ุจูุนุฏู 30-40% ูุน ุจูุงุก ูุงุนุฏุฉ ุนููุงุก ูุฎูุตูู",
                    "ุงูุชุฒุงู ุจุงููุนุงููุฑ ุงูุตุญูุฉ ูุงูุฌูุฏุฉ ุงูุนุงููุฉ",
                    "ููุงูุณุฉ ูู ูุฑุงูุฒ ุตุญูุฉ ุชูููุฏูุฉ ูุญุฏูุซุฉ",
                    "ุงูุญุงุฌุฉ ูุงุณุชุซูุงุฑ ูุณุชูุฑ ูู ุงูุชุฏุฑูุจ ูุงูุชุฌููุฒุงุช"
                ],
                "probability": 50,
                "impact": "ูุชูุณุท ุฅูู ุนุงูู"
            },
            "pessimistic": {
                "title": "ุชุญุฏูุงุช ุชูุธูููุฉ ููุงููุฉ",
                "summary": "ุตุนูุจุงุช ูู ุงูุงูุชุซุงู ูุชุญููู ุงูุงุณุชุฏุงูุฉ ุงููุงููุฉ",
                "details": [
                    "ูุชุทูุจุงุช ุชูุธูููุฉ ุตุงุฑูุฉ ูุชูุงููู ุงูุชุซุงู ุนุงููุฉ",
                    "ุตุนูุจุฉ ูู ุฌุฐุจ ููุงุฏุฑ ุตุญูุฉ ูุคููุฉ",
                    "ุชุญุฏูุงุช ูู ุชุญุตูู ุงููุณุชุญูุงุช ูู ุดุฑูุงุช ุงูุชุฃููู",
                    "ูุฎุงุทุฑ ูุณุคูููุฉ ูุงููููุฉ ูุชูุงููู ุชุฃููู ูุฑุชูุนุฉ"
                ],
                "probability": 18,
                "impact": "ูุชูุณุท ุฅูู ุนุงูู"
            }
        }
    }

    # ุงุฎุชูุงุฑ ุงูุณููุงุฑูููุงุช ุงูููุงุณุจุฉ ุฃู ุงุณุชุฎุฏุงู ุณููุงุฑูููุงุช ุนุงูุฉ
    sector_scenarios = scenarios_db.get(sector, scenarios_db["ุชูููุฉ ุงููุนูููุงุช"])

    # ุชุฎุตูุต ุงูุณููุงุฑูููุงุช ุญุณุจ ุงููููุน ูุงูุฃูู ุงูุฒููู
    time_multipliers = {
        "ูุตูุฑ ุงููุฏู (1-2 ุณูุฉ)": 1.0,
        "ูุชูุณุท ุงููุฏู (3-5 ุณููุงุช)": 1.5,
        "ุทููู ุงููุฏู (5+ ุณููุงุช)": 2.0
    }

    multiplier = time_multipliers.get(time_horizon, 1.0)

    # ุฅุถุงูุฉ ุชูุงุตูู ุฎุงุตุฉ ุจุงููุฎุงูู ุงููุฐููุฑุฉ
    concern_insights = f"\n\n**ุจุฎุตูุต ูุฎุงููู ุญูู '{concern}':**\n"
    if "ููุงูุณ" in concern or "ุงูููุงูุณุฉ" in concern:
        concern_insights += "โข ุงูููุงูุณุฉ ุนุงูู ููู - ูููู ุชุญููููุง ููุฑุตุฉ ูู ุฎูุงู ุงูุชูุงูุฒ ูุงูุงุจุชูุงุฑ\n"
        concern_insights += "โข ุฏุฑุงุณุฉ ุงูููุงูุณูู ุจุนูู ุชุณุงุนุฏ ูู ุชุญุฏูุฏ ุงููุฌูุงุช ูู ุงูุณูู"
    elif "ุชูููู" in concern or "ุงููุงู" in concern or "ุฑุฃุณ ุงููุงู" in concern:
        concern_insights += "โข ุงูุชุฎุทูุท ุงููุงูู ุงูุฏููู ูุงูููู ุงููุณุชุฏุงู ูููู ูู ุงููุฎุงุทุฑ ุงููุงููุฉ\n"
        concern_insights += "โข ุงูุชูููู ุงูุชุฏุฑูุฌู ุฃูุถู ูู ุงูุชูุณุน ุงูุณุฑูุน ุบูุฑ ุงููุฏุฑูุณ"
    elif "ุชููู" in concern or "ุงูุชูููููุฌูุง" in concern:
        concern_insights += "โข ุงูุงุณุชุซูุงุฑ ูู ุงูุชูููุฉ ุงูููุงุณุจุฉ (ููุณ ุงูุฃุญุฏุซ ุฏุงุฆูุงู) ูุญูู ุนุงุฆุฏ ุฃูุถู\n"
        concern_insights += "โข ุงูุดุฑุงูุงุช ุงูุชูููุฉ ูุฏ ุชููู ุฃูุถู ูู ุงูุจูุงุก ูู ุงูุตูุฑ"
    else:
        concern_insights += "โข ุงูุชุฎุทูุท ุงูุฌูุฏ ูุงูุงุณุชุนุฏุงุฏ ููุชุญุฏูุงุช ูููู ูู ุงููุฎุงุทุฑ\n"
        concern_insights += "โข ุงููุฑููุฉ ูุงููุฏุฑุฉ ุนูู ุงูุชููู ุฃุณุงุณูุฉ ูููุฌุงุญ"

    return {
        "optimistic": {
            **sector_scenarios["optimistic"],
            "concern_note": concern_insights
        },
        "realistic": {
            **sector_scenarios["realistic"],
            "concern_note": concern_insights
        },
        "pessimistic": {
            **sector_scenarios["pessimistic"],
            "concern_note": concern_insights
        },
        "executive_summary": f"""
ุจูุงุกู ุนูู ุชุญููู '{project_type}' ูู ูุทุงุน {sector} ุจูููุน {location} ุนูู ุฃูู ุฒููู {time_horizon}ุ
ุชุดูุฑ ุงูุชููุนุงุช ุฅูู ูุฑุต ูุงุนุฏุฉ ูุน ุถุฑูุฑุฉ ุงูุงุณุชุนุฏุงุฏ ููุชุญุฏูุงุช. ุงูุณูู ูุดูุฏ ุชุญููุงุช ูุณุชูุฑุฉ ุชุชุทูุจ
ูุฑููุฉ ููุฏุฑุฉ ุนูู ุงูุงุจุชูุงุฑ. ูุฌุงุญ ุงููุดุฑูุน ูุนุชูุฏ ุนูู ุงูุชุฎุทูุท ุงูุฏูููุ ููู ุงุญุชูุงุฌุงุช ุงูุณููุ
ูุงูุชูููุฐ ุงููุนูุงู ูุน ุงููุฑุงุฌุนุฉ ุงููุณุชูุฑุฉ ููุงุณุชุฑุงุชูุฌูุฉ.

**ุฃุจุฑุฒ ุงูููุงุท:**
- ุงููุฑุต ูุชุงุญุฉ ูููููุง ุชุชุทูุจ ุชูููุฐุงู ููุชุงุฒุงู
- ุงูููุงูุณุฉ ููุฌูุฏุฉ ูุชุฒุฏุงุฏ ูู ูุนุธู ุงููุทุงุนุงุช
- ุงูุชููู ุงูุณุฑูุน ูุงูุงุจุชูุงุฑ ุงููุณุชูุฑ ุถุฑูุฑูุงู
- ุงูุชุฎุทูุท ุงููุงูู ุงููุญูู ูููู ุงููุฎุงุทุฑ ุจุดูู ูุจูุฑ
        """
    }

# ุฏุงูุฉ ูุชูููุฏ ุงููุฑุต ูุงููุฎุงุทุฑ
def generate_opportunities_risks(sector, time_horizon, concern):
    """ุชูููุฏ ููุงุฆู ุงููุฑุต ูุงููุฎุงุทุฑ"""

    opportunities_db = {
        "ุชูููุฉ ุงููุนูููุงุช": [
            "ุงูุชุญูู ุงูุฑููู ุงููุชุณุงุฑุน ูู ุงููุคุณุณุงุช ุงูุญููููุฉ ูุงูุฎุงุตุฉ",
            "ุงุฒุฏูุงุฏ ุงูุงุณุชุซูุงุฑ ูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุชูููุฉ",
            "ููู ุงูุทูุจ ุนูู ุงูุญููู ุงูุณุญุงุจูุฉ ูุงูุฃูู ุงูุณูุจุฑุงูู",
            "ุฏุนู ุญูููู ููู ููุทุงุน ุงูุชูููุฉ ูุงูุงุจุชูุงุฑ",
            "ูุฑุต ุงูุชุตุฏูุฑ ููุฃุณูุงู ุงูุฅูููููุฉ ูุงูุนุงูููุฉ",
            "ููู ุณูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุงูุจูุงูุงุช ุงูุถุฎูุฉ"
        ],
        "ุงูุฎุฏูุงุช ุงูุบุฐุงุฆูุฉ": [
            "ููู ูุทุงุน ุงููุทุงุนู ูุงูููุงูู ุจูุณุจุฉ 8-12% ุณูููุงู",
            "ุงุฒุฏูุงุฏ ุงูุฅููุงู ุนูู ุงูุทุนุงู ุฎุงุฑุฌ ุงูููุฒู",
            "ูุฑุต ุงูุชูุณุน ูู ุฎุฏูุงุช ุงูุชูุตูู ูุงูุทูุจุงุช ุงูุฅููุชุฑูููุฉ",
            "ุฅููุงููุฉ ุจูุงุก ุนูุงูุฉ ุชุฌุงุฑูุฉ ูููุฒุฉ",
            "ูุฑุต ุงูุงูุชูุงุฒ ุงูุชุฌุงุฑู ุจุนุฏ ูุฌุงุญ ุงููุฑุน ุงูุฃูู",
            "ุชุฒุงูุฏ ุงูุงูุชูุงู ุจุงูุฃุทุนูุฉ ุงูุตุญูุฉ ูุงูุนุถููุฉ"
        ],
        "ุงูุชุนููู ูุงูุชุฏุฑูุจ": [
            "ุงูุทูุจ ุงููุชุฒุงูุฏ ุนูู ุงูุชุนููู ุงููุณุชูุฑ ูุชุทููุฑ ุงูููุงุฑุงุช",
            "ุฏุนู ุญูููู ูุจุฑุงูุฌ ุงูุชุฏุฑูุจ ูุงูุชุทููุฑ",
            "ููู ุณูู ุงูุชุนููู ุงูุฅููุชุฑููู ุจูุณุจุฉ ุชุชุฌุงูุฒ 20% ุณูููุงู",
            "ูุฑุต ุงูุดุฑุงูุงุช ูุน ุงูุดุฑูุงุช ุงููุจุฑู",
            "ุฅููุงููุฉ ุงููุตูู ูุฌูููุฑ ูุงุณุน ุนุจุฑ ุงูุฅูุชุฑูุช",
            "ุชุฒุงูุฏ ุงูุญุงุฌุฉ ูููุงุฑุงุช ุชูููุฉ ูููููุฉ ูุชุฎุตุตุฉ"
        ],
        "ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ": [
            "ููู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ ุจูุนุฏู 25-30% ุณูููุงู",
            "ุชุญุณู ุงูุจููุฉ ุงูุชุญุชูุฉ ููุฎุฏูุงุช ุงูููุฌุณุชูุฉ ูุงูุฏูุน",
            "ุงุฒุฏูุงุฏ ุซูุฉ ุงููุณุชููููู ูู ุงูุดุฑุงุก ุนุจุฑ ุงูุฅูุชุฑูุช",
            "ูุฑุต ุงูุจูุน ุนุจุฑ ุงูุญุฏูุฏ ูุงูุฃุณูุงู ุงูุฅูููููุฉ",
            "ุฅููุงููุฉ ุงูุงุณุชูุงุฏุฉ ูู ุงูุจูุงูุงุช ูุชุญุณูู ุงูุชุฌุฑุจุฉ",
            "ููู ุงูุชุณูู ุนุจุฑ ุงููุงุชู ุงููุญููู"
        ],
        "ุงูุตุญุฉ ูุงูุนุงููุฉ": [
            "ูุนู ูุชุฒุงูุฏ ุจุฃูููุฉ ุงูุตุญุฉ ุงูููุงุฆูุฉ",
            "ููู ุณูู ุงูููุงูุฉ ุงูุจุฏููุฉ ูุงูุนุงููุฉ",
            "ุฒูุงุฏุฉ ุงูุฅููุงู ุนูู ุงูุตุญุฉ ูุงูุฑุนุงูุฉ ุงูุดุฎุตูุฉ",
            "ูุฑุต ุงูุดุฑุงูุงุช ูุน ุดุฑูุงุช ุงูุชุฃููู ูุงููุคุณุณุงุช",
            "ุชุฒุงูุฏ ุงูุทูุจ ุนูู ุงูุฎุฏูุงุช ุงูุตุญูุฉ ุงููุชุฎุตุตุฉ",
            "ุฏุนู ุญูููู ููุทุงุน ุงูุตุญุฉ ุงูุฎุงุตุฉ"
        ]
    }

    risks_db = {
        "ุชูููุฉ ุงููุนูููุงุช": [
            "ููุงูุณุฉ ุดุฏูุฏุฉ ูู ุดุฑูุงุช ุชูููุฉ ุฑุงุณุฎุฉ ููุญููุฉ ูุนุงูููุฉ",
            "ุณุฑุนุฉ ุงูุชุบูุฑ ุงูุชูููููุฌู ุชุชุทูุจ ุชุทููุฑ ูุณุชูุฑ",
            "ุตุนูุจุฉ ุงุณุชูุทุงุจ ูุงูุงุญุชูุงุธ ุจุงูููุงุกุงุช ุงูุชูููุฉ",
            "ุชุญุฏูุงุช ุงูุฃูู ุงูุณูุจุฑุงูู ูุญูุงูุฉ ุงูุจูุงูุงุช",
            "ุชุบูุฑุงุช ุชูุธูููุฉ ูููุงููู ุญูุงูุฉ ุงูุจูุงูุงุช",
            "ูุฎุงุทุฑ ุงูุงุนุชูุงุฏ ุนูู ุชูููุงุช ุทุฑู ุซุงูุซ"
        ],
        "ุงูุฎุฏูุงุช ุงูุบุฐุงุฆูุฉ": [
            "ููุงูุณุฉ ุดุฑุณุฉ ูู ูุทุงุนู ุฑุงุณุฎุฉ ูุณูุงุณู ุนุงูููุฉ",
            "ุงุฑุชูุงุน ุชูุงููู ุงูุชุดุบูู (ุฅูุฌุงุฑุ ุนูุงูุฉุ ููุงุฏ ุฎุงู)",
            "ุชููุจุงุช ูู ุฃุณุนุงุฑ ุงูููุงุฏ ุงูุบุฐุงุฆูุฉ",
            "ุตุฑุงูุฉ ุงููุชุทูุจุงุช ุงูุตุญูุฉ ูุงูุฑูุงุจูุฉ",
            "ุชุบูุฑ ุฃุฐูุงู ุงููุณุชููููู ูููุณููุฉ ุงูุทูุจ",
            "ูุฎุงุทุฑ ุณูุนุฉ ูู ุญุงุฏุซ ุตุญู ูุงุญุฏ"
        ],
        "ุงูุชุนููู ูุงูุชุฏุฑูุจ": [
            "ุชุดุจุน ุงูุณูู ูู ุจุนุถ ุงููุฌุงูุงุช ุงูุชุฏุฑูุจูุฉ",
            "ููุงูุณุฉ ูู ููุตุงุช ุชุนููู ุนุงูููุฉ ูุฌุงููุฉ ููุฏููุนุฉ",
            "ุตุนูุจุฉ ุฅุซุจุงุช ุงูุนุงุฆุฏ ุนูู ุงูุงุณุชุซูุงุฑ ูู ุงูุชุฏุฑูุจ",
            "ุชุญุฏูุงุช ูู ุฌุฐุจ ูุงูุงุญุชูุงุธ ุจูุฏุฑุจูู ุฃููุงุก",
            "ุชุบูุฑ ุงุญุชูุงุฌุงุช ุงูุณูู ูู ุงูููุงุฑุงุช",
            "ูุฎุงุทุฑ ุชูุธูููุฉ ููุชุทูุจุงุช ุงูุงุนุชูุงุฏ"
        ],
        "ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ": [
            "ููุงูุณุฉ ูู ููุตุงุช ูุจุฑู ูุซู ุฃูุงุฒูู ูููู",
            "ุงุฑุชูุงุน ุชูุงููู ุงูุชุณุงุจ ุงูุนููุงุก ูุงูุชุณููู ุงูุฑููู",
            "ุชุญุฏูุงุช ุงูุฎุฏูุงุช ุงูููุฌุณุชูุฉ ูุงูุดุญู",
            "ูุดุงูู ุฅุฑุฌุงุน ุงูููุชุฌุงุช ูุฎุฏูุฉ ุงูุนููุงุก",
            "ูุฎุงุทุฑ ุงูุงุญุชูุงู ูุงููุฏููุนุงุช ุงูุฅููุชุฑูููุฉ",
            "ุตุนูุจุฉ ุจูุงุก ุงูุซูุฉ ูุน ุนููุงุก ุฌุฏุฏ"
        ],
        "ุงูุตุญุฉ ูุงูุนุงููุฉ": [
            "ูุชุทูุจุงุช ุชูุธูููุฉ ูุชุฑุฎูุตูุฉ ุตุงุฑูุฉ",
            "ูุฎุงุทุฑ ุงููุณุคูููุฉ ุงููุงููููุฉ ูุงูุทุจูุฉ",
            "ุชูุงููู ุงูุชุฃููู ุงููุฑุชูุนุฉ",
            "ุตุนูุจุฉ ุงุณุชูุทุงุจ ููุงุฏุฑ ุตุญูุฉ ูุคููุฉ",
            "ููุงูุณุฉ ูู ูุฑุงูุฒ ุตุญูุฉ ุฑุงุณุฎุฉ ููุณุชุดููุงุช",
            "ุชุญุฏูุงุช ูู ุชุญุตูู ุงููุณุชุญูุงุช ูู ุงูุชุฃููู"
        ]
    }

    sector_opps = opportunities_db.get(sector, opportunities_db["ุชูููุฉ ุงููุนูููุงุช"])
    sector_risks = risks_db.get(sector, risks_db["ุชูููุฉ ุงููุนูููุงุช"])

    return {
        "opportunities": sector_opps[:6],
        "risks": sector_risks[:6]
    }

# ุฏุงูุฉ ูุชูููุฏ ุงูุฃุณุฆูุฉ ุงูุงุณุชุดุฑุงููุฉ
def generate_foresight_questions(project_type, sector, concern):
    """ุชูููุฏ ุฃุณุฆูุฉ ุงุณุชุดุฑุงููุฉ ุฐููุฉ"""

    questions = [
        f"ูุงุฐุง ูู ุชุบูุฑุช ุงุญุชูุงุฌุงุช ุงูุนููุงุก ูู ูุทุงุน {sector} ุจุดูู ุฌุฐุฑู ุฎูุงู ุงูุณูุชูู ุงููุงุฏูุชููุ",
        f"ูุงุฐุง ูู ุฏุฎู ููุงูุณ ูุจูุฑ (ูุญูู ุฃู ุนุงููู) ุฅูู ุณูู {sector} ูู ููุทูุชูุ",
        f"ูุงุฐุง ูู ุฃุตุจุญุช ุงูุชูููุงุช ุงูุฌุฏูุฏุฉ (ุงูุฐูุงุก ุงูุงุตุทูุงุนูุ ุงูุชุดุบูู ุงูุขูู) ูุนูุงุฑุงู ุฃุณุงุณูุงู ูู {sector}ุ",
        f"ูุงุฐุง ูู ุชุบูุฑุช ุงูููุงููู ูุงูุฃูุธูุฉ ุงููุชุนููุฉ ุจู{sector} ุจุดูู ูุจูุฑุ",
        f"ูุงุฐุง ูู ูุงุฌู '{project_type}' ุฃุฒูุฉ ุงูุชุตุงุฏูุฉ ุฃู ุงูููุงุด ูู ุงูุณููุ",
        f"ูุงุฐุง ูู ุฃุตุจุญ ุงูุนููุงุก ููุถููู ูููุฐุฌ ุนูู ูุฎุชูู ุชูุงูุงู ุนู ูููุฐุฌู ุงูุญุงููุ",
        f"ูุงุฐุง ูู ุธูุฑุช ูุฑุตุฉ ุชูุณุน ูุจูุฑุฉ ูููููุง ุชุชุทูุจ ุงุณุชุซูุงุฑุงู ุถุฎูุงู - ูู ุฃูุช ูุณุชุนุฏุ"
    ]

    # ุฅุถุงูุฉ ุณุคุงู ูุฎุตุต ุจูุงุกู ุนูู ุงููุฎุงูู
    if concern:
        questions.insert(2, f"ูุงุฐุง ูู ุชุญูู ุงูููู ุงูุฃูุจุฑ ูุฏูู ุจุฎุตูุต '{concern}'ุ")

    return questions[:7]

# ุงูุญุงูุฉ ุงูุฃูููุฉ
if 'analysis_done' not in st.session_state:
    st.session_state.analysis_done = False

# ุงูุนููุงู ุงูุฑุฆูุณู
st.markdown('<h1 class="header-title">๐ฎ ุฃุฏุงุฉ ุงูุงุณุชุดุฑุงู ุงูุฐูู</h1>', unsafe_allow_html=True)
st.markdown('<p class="header-subtitle">ูุธูู ุชูููุฑู ุญูู ุงููุณุชูุจู ูุจู ุงุชุฎุงุฐ ุงููุฑุงุฑ</p>', unsafe_allow_html=True)

# ุงูุฌุฒุก ุงูุฃูู: ูููุฐุฌ ุงูุฅุฏุฎุงู
if not st.session_state.analysis_done:
    st.markdown("---")
    st.markdown("### ๐ ูุนูููุงุช ุงููุดุฑูุน ุฃู ุงููุฑุงุฑ")

    col1, col2 = st.columns(2)

    with col1:
        project_type = st.text_input(
            "๐ฏ ููุน ุงููุดุฑูุน ุฃู ุงููุฑุงุฑ",
            placeholder="ูุซุงู: ุงูุชุชุงุญ ูุทุนูุ ุชุทููุฑ ุชุทุจููุ ุฎุฏูุฉ ุงุณุชุดุงุฑูุฉ...",
            help="ุตู ุจุฅูุฌุงุฒ ุทุจูุนุฉ ุงููุดุฑูุน ุฃู ุงููุฑุงุฑ ุงูุฐู ุชููุฑ ููู"
        )

        location = st.text_input(
            "๐ ุงููููุน",
            placeholder="ูุซุงู: ุงูุฑูุงุถุ ุฌุฏุฉุ ุฏุจู...",
            help="ุงููุฏููุฉ ุฃู ุงูููุทูุฉ ุงูุชู ุณูุนูู ูููุง ุงููุดุฑูุน"
        )

        sector = st.selectbox(
            "๐ข ุงููุทุงุน",
            [
                "ุชูููุฉ ุงููุนูููุงุช",
                "ุงูุฎุฏูุงุช ุงูุบุฐุงุฆูุฉ",
                "ุงูุชุนููู ูุงูุชุฏุฑูุจ",
                "ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ",
                "ุงูุตุญุฉ ูุงูุนุงููุฉ",
                "ุงูุฎุฏูุงุช ุงูููููุฉ",
                "ุงูุชุตููุน",
                "ุงูุนูุงุฑุงุช",
                "ุงูุณูุงุญุฉ ูุงูุถูุงูุฉ",
                "ุงูููู ูุงูููุฌุณุชูุงุช"
            ],
            help="ุงุฎุชุฑ ุงููุทุงุน ุงูุฃูุฑุจ ููุดุฑูุนู"
        )

    with col2:
        time_horizon = st.selectbox(
            "โฐ ุงูุฃูู ุงูุฒููู",
            [
                "ูุตูุฑ ุงููุฏู (1-2 ุณูุฉ)",
                "ูุชูุณุท ุงููุฏู (3-5 ุณููุงุช)",
                "ุทููู ุงููุฏู (5+ ุณููุงุช)"
            ],
            help="ูุง ุงููุฏุฉ ุงูุฒูููุฉ ุงูุชู ุชููุฑ ูููุง ููุชุฎุทูุทุ"
        )

        concern = st.text_area(
            "๐ญ ุฃูุซุฑ ุดูุก ููููู ุจุดุฃู ุงููุณุชูุจู",
            placeholder="ูุซุงู: ุงูููุงูุณุฉ ุงูุดุฏูุฏุฉุ ุนุฏู ูุฌูุฏ ุชูููู ูุงููุ ุงูุชุบูุฑุงุช ุงูุชูููุฉ ุงูุณุฑูุนุฉ...",
            help="ุดุงุฑู ุฃูุจุฑ ูุฎุงููู - ุณูุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุงูุชุญููู",
            height=150
        )

    st.markdown("---")

    # ุฒุฑ ุงูุชุญููู
    col_center = st.columns([1, 2, 1])[1]
    with col_center:
        analyze_button = st.button("๐ ุงุจุฏุฃ ุงูุชุญููู ุงูุงุณุชุดุฑุงูู", use_container_width=True)

    if analyze_button:
        # ุงูุชุญูู ูู ุงูุชูุงู ุงูุจูุงูุงุช
        if not project_type or not location or not concern:
            st.error("โ๏ธ ุงูุฑุฌุงุก ุฅููุงู ุฌููุน ุงูุญููู ุงููุทููุจุฉ")
        else:
            # ุนุฑุถ ูุคุดุฑ ุงูุชุญููู
            with st.spinner("๐ ุฌุงุฑู ุชูููุฏ ุงูุณููุงุฑูููุงุช ุงููุณุชูุจููุฉ..."):
                time.sleep(2)  # ูุญุงูุงุฉ ุงููุนุงูุฌุฉ

                # ุชูููุฏ ุงูุชุญููู
                st.session_state.scenarios = generate_scenarios(
                    project_type, location, sector, time_horizon, concern
                )
                st.session_state.opp_risks = generate_opportunities_risks(
                    sector, time_horizon, concern
                )
                st.session_state.questions = generate_foresight_questions(
                    project_type, sector, concern
                )
                st.session_state.project_info = {
                    "project_type": project_type,
                    "location": location,
                    "sector": sector,
                    "time_horizon": time_horizon,
                    "concern": concern
                }
                st.session_state.analysis_done = True
                st.rerun()

# ุงูุฌุฒุก ุงูุซุงูู: ุนุฑุถ ุงููุชุงุฆุฌ
else:
    # ุนุฑุถ ูุนูููุงุช ุงููุดุฑูุน ูู ุงูุฃุนูู
    st.markdown("### ๐ ูุชุงุฆุฌ ุงูุชุญููู ุงูุงุณุชุดุฑุงูู")

    col1, col2, col3, col4 = st.columns(4)
    with col1:
        st.markdown(f"""
        <div class="metric-card">
            <div class="metric-label">ููุน ุงููุดุฑูุน</div>
            <div style="font-size: 16px; font-weight: 600; color: #2d3748; margin-top: 8px;">
                {st.session_state.project_info['project_type']}
            </div>
        </div>
        """, unsafe_allow_html=True)

    with col2:
        st.markdown(f"""
        <div class="metric-card">
            <div class="metric-label">ุงููููุน</div>
            <div style="font-size: 16px; font-weight: 600; color: #2d3748; margin-top: 8px;">
                {st.session_state.project_info['location']}
            </div>
        </div>
        """, unsafe_allow_html=True)

    with col3:
        st.markdown(f"""
        <div class="metric-card">
            <div class="metric-label">ุงููุทุงุน</div>
            <div style="font-size: 16px; font-weight: 600; color: #2d3748; margin-top: 8px;">
                {st.session_state.project_info['sector']}
            </div>
        </div>
        """, unsafe_allow_html=True)

    with col4:
        st.markdown(f"""
        <div class="metric-card">
            <div class="metric-label">ุงูุฃูู ุงูุฒููู</div>
            <div style="font-size: 16px; font-weight: 600; color: #2d3748; margin-top: 8px;">
                {st.session_state.project_info['time_horizon']}
            </div>
        </div>
        """, unsafe_allow_html=True)

    st.markdown("---")

    # 1) ุงูููุฎุต ุงูุชูููุฐู
    st.markdown('<h2 class="section-header">๐ ุงูููุฎุต ุงูุชูููุฐู</h2>', unsafe_allow_html=True)
    st.markdown(f"""
    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);
                border-right: 5px solid #667eea; line-height: 1.8;">
        {st.session_state.scenarios['executive_summary']}
    </div>
    """, unsafe_allow_html=True)

    st.markdown("<br>", unsafe_allow_html=True)

    # 2) ุงูุณููุงุฑูููุงุช ุงููุณุชูุจููุฉ
    st.markdown('<h2 class="section-header">๐ฏ ุงูุณููุงุฑูููุงุช ุงููุณุชูุจููุฉ</h2>', unsafe_allow_html=True)

    # ุฎูุงุฑ ุงูุนุฑุถ (ูุฎุชุตุฑ ุฃู ููุตู)
    view_mode = st.radio(
        "ุทุฑููุฉ ุงูุนุฑุถ:",
        ["ุนุฑุถ ูุฎุชุตุฑ", "ุนุฑุถ ุชูุตููู"],
        horizontal=True,
        label_visibility="collapsed"
    )

    detailed = (view_mode == "ุนุฑุถ ุชูุตููู")

    # ุณููุงุฑูู ูุชูุงุฆู
    st.markdown(f"""
    <div class="scenario-card optimistic">
        <h3 style="color: #48bb78; margin-bottom: 15px;">
            ๐ ุงูุณููุงุฑูู ุงููุชูุงุฆู: {st.session_state.scenarios['optimistic']['title']}
        </h3>
        <p style="font-size: 16px; color: #2d3748; line-height: 1.8; margin-bottom: 15px;">
            {st.session_state.scenarios['optimistic']['summary']}
        </p>
    """, unsafe_allow_html=True)

    if detailed:
        st.markdown('<p style="font-weight: 600; color: #2d3748; margin-top: 20px;">ุงูุชูุงุตูู ุงูุฑุฆูุณูุฉ:</p>', unsafe_allow_html=True)
        for detail in st.session_state.scenarios['optimistic']['details']:
            st.markdown(f"โข {detail}")
        st.markdown(f"""
        <div style="background: #f0fff4; padding: 12px; border-radius: 8px; margin-top: 15px;">
            <strong>ุงุญุชูุงููุฉ ุงูุญุฏูุซ:</strong> {st.session_state.scenarios['optimistic']['probability']}% |
            <strong>ุงูุชุฃุซูุฑ ุงููุชููุน:</strong> {st.session_state.scenarios['optimistic']['impact']}
        </div>
        """, unsafe_allow_html=True)

    st.markdown("</div>", unsafe_allow_html=True)

    # ุณููุงุฑูู ูุงูุนู
    st.markdown(f"""
    <div class="scenario-card realistic">
        <h3 style="color: #4299e1; margin-bottom: 15px;">
            โ๏ธ ุงูุณููุงุฑูู ุงููุฑุฌุญ (ุงููุงูุนู): {st.session_state.scenarios['realistic']['title']}
        </h3>
        <p style="font-size: 16px; color: #2d3748; line-height: 1.8; margin-bottom: 15px;">
            {st.session_state.scenarios['realistic']['summary']}
        </p>
    """, unsafe_allow_html=True)

    if detailed:
        st.markdown('<p style="font-weight: 600; color: #2d3748; margin-top: 20px;">ุงูุชูุงุตูู ุงูุฑุฆูุณูุฉ:</p>', unsafe_allow_html=True)
        for detail in st.session_state.scenarios['realistic']['details']:
            st.markdown(f"โข {detail}")
        st.markdown(f"""
        <div style="background: #ebf8ff; padding: 12px; border-radius: 8px; margin-top: 15px;">
            <strong>ุงุญุชูุงููุฉ ุงูุญุฏูุซ:</strong> {st.session_state.scenarios['realistic']['probability']}% |
            <strong>ุงูุชุฃุซูุฑ ุงููุชููุน:</strong> {st.session_state.scenarios['realistic']['impact']}
        </div>
        """, unsafe_allow_html=True)

    st.markdown("</div>", unsafe_allow_html=True)

    # ุณููุงุฑูู ูุชุดุงุฆู
    st.markdown(f"""
    <div class="scenario-card pessimistic">
        <h3 style="color: #f56565; margin-bottom: 15px;">
            โ๏ธ ุงูุณููุงุฑูู ุงููุชุดุงุฆู: {st.session_state.scenarios['pessimistic']['title']}
        </h3>
        <p style="font-size: 16px; color: #2d3748; line-height: 1.8; margin-bottom: 15px;">
            {st.session_state.scenarios['pessimistic']['summary']}
        </p>
    """, unsafe_allow_html=True)

    if detailed:
        st.markdown('<p style="font-weight: 600; color: #2d3748; margin-top: 20px;">ุงูุชูุงุตูู ุงูุฑุฆูุณูุฉ:</p>', unsafe_allow_html=True)
        for detail in st.session_state.scenarios['pessimistic']['details']:
            st.markdown(f"โข {detail}")
        st.markdown(f"""
        <div style="background: #fff5f5; padding: 12px; border-radius: 8px; margin-top: 15px;">
            <strong>ุงุญุชูุงููุฉ ุงูุญุฏูุซ:</strong> {st.session_state.scenarios['pessimistic']['probability']}% |
            <strong>ุงูุชุฃุซูุฑ ุงููุชููุน:</strong> {st.session_state.scenarios['pessimistic']['impact']}
        </div>
        """, unsafe_allow_html=True)

    st.markdown("</div>", unsafe_allow_html=True)

    # ุฑุณู ุจูุงูู ููุงุญุชูุงููุงุช
    if detailed:
        st.markdown("<br>", unsafe_allow_html=True)
        fig = go.Figure(data=[
            go.Bar(
                x=['ุงูุณููุงุฑูู ุงููุชูุงุฆู', 'ุงูุณููุงุฑูู ุงููุฑุฌุญ', 'ุงูุณููุงุฑูู ุงููุชุดุงุฆู'],
                y=[
                    st.session_state.scenarios['optimistic']['probability'],
                    st.session_state.scenarios['realistic']['probability'],
                    st.session_state.scenarios['pessimistic']['probability']
                ],
                marker_color=['#48bb78', '#4299e1', '#f56565'],
                text=[
                    f"{st.session_state.scenarios['optimistic']['probability']}%",
                    f"{st.session_state.scenarios['realistic']['probability']}%",
                    f"{st.session_state.scenarios['pessimistic']['probability']}%"
                ],
                textposition='auto',
            )
        ])
        fig.update_layout(
            title="ุงุญุชูุงููุฉ ุญุฏูุซ ูู ุณููุงุฑูู",
            yaxis_title="ุงูุงุญุชูุงููุฉ (%)",
            height=400,
            font=dict(family="Cairo", size=14),
            plot_bgcolor='rgba(0,0,0,0)',
            paper_bgcolor='white',
            showlegend=False
        )
        st.plotly_chart(fig, use_container_width=True)

    st.markdown("<br>", unsafe_allow_html=True)

    # 3) ุงููุฑุต ูุงููุฎุงุทุฑ
    st.markdown('<h2 class="section-header">โก ุงููุฑุต ูุงููุฎุงุทุฑ</h2>', unsafe_allow_html=True)

    col_opp, col_risk = st.columns(2)

    with col_opp:
        st.markdown("### โ ุงููุฑุต ุงููุชุงุญุฉ")
        for i, opp in enumerate(st.session_state.opp_risks['opportunities'], 1):
            st.markdown(f"""
            <div class="opportunity-item">
                <strong>{i}.</strong> {opp}
            </div>
            """, unsafe_allow_html=True)

    with col_risk:
        st.markdown("### โ๏ธ ุงููุฎุงุทุฑ ุงููุญุชููุฉ")
        for i, risk in enumerate(st.session_state.opp_risks['risks'], 1):
            st.markdown(f"""
            <div class="risk-item">
                <strong>{i}.</strong> {risk}
            </div>
            """, unsafe_allow_html=True)

    st.markdown("<br>", unsafe_allow_html=True)

    # 4) ุงูุฃุณุฆูุฉ ุงูุงุณุชุดุฑุงููุฉ
    st.markdown('<h2 class="section-header">โ ุฃุณุฆูุฉ ุงุณุชุดุฑุงููุฉ ููุชูููุฑ ุงูุนููู</h2>', unsafe_allow_html=True)
    st.markdown('<p style="color: #4a5568; margin-bottom: 20px;">ูุฐู ุงูุฃุณุฆูุฉ ุชุณุงุนุฏู ุนูู ุงุณุชูุดุงู ุณููุงุฑูููุงุช ูุฎุชููุฉ ูุงูุงุณุชุนุฏุงุฏ ูููุณุชูุจู:</p>', unsafe_allow_html=True)

    for i, question in enumerate(st.session_state.questions, 1):
        st.markdown(f"""
        <div class="question-item">
            <strong>ุงูุณุคุงู {i}:</strong> {question}
        </div>
        """, unsafe_allow_html=True)

    st.markdown("<br><br>", unsafe_allow_html=True)

    # 5) ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช
    col1, col2, col3 = st.columns([1, 1, 1])

    with col1:
        # ุฒุฑ ุชุญููู ุงูุชูุฑูุฑ
        report_data = {
            "project_info": st.session_state.project_info,
            "scenarios": st.session_state.scenarios,
            "opportunities_risks": st.session_state.opp_risks,
            "questions": st.session_state.questions,
            "generated_at": datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        }

        report_json = json.dumps(report_data, ensure_ascii=False, indent=2)

        st.download_button(
            label="๐ฅ ุชุญููู ุงูุชูุฑูุฑ (JSON)",
            data=report_json,
            file_name=f"ุชูุฑูุฑ_ุงุณุชุดุฑุงูู_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json",
            mime="application/json",
            use_container_width=True
        )

    with col2:
        # ุฒุฑ ุชุญููู ุฌุฏูุฏ
        if st.button("๐ ุชุญููู ูุดุฑูุน ุฌุฏูุฏ", use_container_width=True):
            st.session_state.analysis_done = False
            st.rerun()

    with col3:
        # ุฒุฑ ูุดุงุฑูุฉ (placeholder)
        st.button("๐ค ูุดุงุฑูุฉ ุงูุชูุฑูุฑ", use_container_width=True, disabled=True,
                 help="ูุฑูุจุงู: ุฅููุงููุฉ ูุดุงุฑูุฉ ุงูุชูุฑูุฑ ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู")

    # ุงูุชูููู ุงููุงูููู
    st.markdown("""
    <div class="disclaimer">
        <strong>โ๏ธ ุชูููู ููู:</strong> ูุฐู ุงูุฃุฏุงุฉ ุชูุฏู ุชุญูููุงู ุงุณุชุดุฑุงููุงู ูููุณุงุนุฏุฉ ูู ุงูุชูููุฑ ุงูุงุณุชุฑุงุชูุฌู ููุท.
        ูุง ุชุชูุจุฃ ุจุงููุณุชูุจู ููุง ุชูุฏู ุชูุตูุงุช ุงุณุชุซูุงุฑูุฉ ุฃู ูุงููููุฉ ุฃู ูุงููุฉ. ูููุตุญ ุจุงุณุชุดุงุฑุฉ
        ุฎุจุฑุงุก ูุชุฎุตุตูู ูุจู ุงุชุฎุงุฐ ุฃู ูุฑุงุฑุงุช ูุตูุฑูุฉ.
    </div>
    """, unsafe_allow_html=True)

# Footer
st.markdown("<br><br>", unsafe_allow_html=True)
st.markdown("""
<div style="text-align: center; color: #718096; font-size: 14px; padding: 20px;">
    <p>ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ ุฃุฏุงุฉ ุงูุงุณุชุดุฑุงู ุงูุฐูู โข ุงููุณุฎุฉ ุงูุฃูููุฉ (MVP) โข 2026</p>
</div>
""", unsafe_allow_html=True)
